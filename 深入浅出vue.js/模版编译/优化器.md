## 优化器
解析器的作用是将HTML模版解析成AST，而优化器的作用是在AST中找出静态子树并打上标记  
静态子树就是永远都不会发生变化的节点，一个纯文本节点就是静态子树，而带变量的文本节点就不是静态子树  
标记静态子树有两点好处：  
* 每次重新渲染时，不需要为静态子树创建新节点，而是直接克隆已存在的静态子树
* 在虚拟DOM中打补丁（patching) 的过程可以跳过  

优化器的内部实现主要分为两个步骤： 
* 在AST中找出所有静态节点并打上标记
* 在AST中找出所有静态根节点并打上标记  

````js
// 静态节点
<p>我是静态节点，我不需要发生变化</p>

// 对应的AST
{
    type: 1,
    tag: 'p',
    staticRoot: false,
    static: true
    ...
}

// 静态根节点 ul
<ul>
   <li>我是静态节点1</li> 
   <li>我是静态节点2</li>
</ul>

{
    type: 1,
    tag: 'ul',
    staticRoot: true,
    static: true,
    ...
}
````
### 找出所有静态节点并标记
从根节点开始，判断根节点是不是静态根节点，递归处理子节点
````js
function markStatic(node){
    node.static = isStatic(node)
    // type等于1 是元素节点
    if(node.type === 1){
        for(let i=0; i<node.children.length; i++){
           const child = node.childrn[i]
           makeStatic(child)
        }
    }
}
````

